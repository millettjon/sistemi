<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>util.except documentation</title></head><body><div id="header"><h1><a href="index.html">Sistemi 0.1 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="app.config.html"><span>app.config</span></a></li><li><a href="app.config.core.html"><span>app.config.core</span></a></li><li><a href="app.run-level.html"><span>app.run-level</span></a></li><li><a href="git.html"><span>git</span></a></li><li><a href="harpocrates.core.html"><span>harpocrates.core</span></a></li><li><a href="locale.core.html"><span>locale.core</span></a></li><li><a href="locale.handler.redirect.html"><span>locale.handler.redirect</span></a></li><li><a href="locale.middleware.locale.html"><span>locale.middleware.locale</span></a></li><li><a href="locale.translate.html"><span>locale.translate</span></a></li><li><a href="log.readably.html"><span>log.readably</span></a></li><li><a href="paypal.html"><span>paypal</span></a></li><li><a href="paypal.address.html"><span>paypal.address</span></a></li><li><a href="paypal.config.html"><span>paypal.config</span></a></li><li><a href="paypal.core.html"><span>paypal.core</span></a></li><li><a href="paypal.nvp.html"><span>paypal.nvp</span></a></li><li><a href="sistemi.config.html"><span>sistemi.config</span></a></li><li><a href="sistemi.form.html"><span>sistemi.form</span></a></li><li><a href="sistemi.handler.html"><span>sistemi.handler</span></a></li><li><a href="sistemi.layout.html"><span>sistemi.layout</span></a></li><li><a href="sistemi.middleware.html"><span>sistemi.middleware</span></a></li><li><a href="sistemi.model.html"><span>sistemi.model</span></a></li><li><a href="sistemi.model.format.html"><span>sistemi.model.format</span></a></li><li><a href="sistemi.model.shelving.html"><span>sistemi.model.shelving</span></a></li><li><a href="sistemi.registry.html"><span>sistemi.registry</span></a></li><li><a href="sistemi.routes.html"><span>sistemi.routes</span></a></li><li><a href="sistemi.site.html"><span>sistemi.site</span></a></li><li><a href="sistemi.site.cart.add.html"><span>sistemi.site.cart.add</span></a></li><li><a href="sistemi.site.order.checkout.html"><span>sistemi.site.order.checkout</span></a></li><li><a href="sistemi.translate.html"><span>sistemi.translate</span></a></li><li><a href="track.usage.html"><span>track.usage</span></a></li><li><a href="upu.html"><span>upu</span></a></li><li><a href="util.base62.html"><span>util.base62</span></a></li><li><a href="util.core.html"><span>util.core</span></a></li><li><a href="util.environment.html"><span>util.environment</span></a></li><li><a href="util.example.html"><span>util.example</span></a></li><li class="current"><a href="util.except.html"><span>util.except</span></a></li><li><a href="util.path.html"><span>util.path</span></a></li><li><a href="util.pojometa.html"><span>util.pojometa</span></a></li><li><a href="util.reflection.html"><span>util.reflection</span></a></li><li><a href="util.string.html"><span>util.string</span></a></li><li><a href="www.form.html"><span>www.form</span></a></li><li><a href="www.id.html"><span>www.id</span></a></li><li><a href="www.middleware.html"><span>www.middleware</span></a></li><li><a href="www.request.html"><span>www.request</span></a></li><li><a href="www.url.html"><span>www.url</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="util.except.html#var-check"><span>check</span></a></li><li><a href="util.except.html#var-die"><span>die</span></a></li><li><a href="util.except.html#var-safely"><span>safely</span></a></li><li><a href="util.except.html#var-swallow"><span>swallow</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>util.except documentation</h2><pre class="doc">Macros for handling and throwing exceptions.
</pre><div class="public" id="var-check"><h3>check</h3><div class="usage"><code>(check expr)</code><code>(check expr arg)</code><code>(check expr validate-fn format-string &amp; format-args)</code></div><pre class="doc">Evaluates expr and validates the result. The result is returned if validation succeeds. Otherwise, an
exception is thrown.

A custom validator function can be passed. If not passed, the function identity will be used to
test for logical truth of the result.

A custom error message format and optional format arguments may be passed. The error message is
constructed using the cl-format function with the supplied format and args. During formatting,
the offending result value will be inserted as the first format arg.

EXAMPLES

;; Simple message.
(swallow (check :zz #{:en :es :de :fr} &quot;I don't know that language.&quot;))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: I don't know that language.&gt;

;; Format string that includes the offending value.
(swallow (check :zz #{:en :es :de :fr} &quot;I don't speak '~A'. Are you asleep?&quot;))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: I don't speak ':zz'. Are you asleep?&gt;

;; Format string with additional arguments. Note that the offending value is inserted as the
;; first format argument.
(let [langs #{:en :es :de :fr}]
  (swallow (check :zz langs &quot;I don't speak '~A'. I do speak ~{~a~^, ~}.&quot; langs)))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: I don't speak ':zz'. I do speak :en, :es, :de, :fr.&gt;

;; If the validator function is omitted, logical truth will be tested.
(swallow (check nil &quot;Am I the eggman.&quot;))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: Am I the eggman.&gt;

(swallow (check false &quot;Am I the eggman? ~A.&quot;))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: Am I the eggman? false.&gt;

(swallow (check false &quot;Am I the eggman? ~A (~A).&quot; &quot;goo goo g'joob&quot;))
=&gt; #&lt;RuntimeException java.lang.RuntimeException: Am I the eggman? false (goo goo g'joob).&gt;</pre></div><div class="public" id="var-die"><h3>die</h3><div class="usage"><code>(die message)</code><code>(die format-string &amp; format-args)</code></div><pre class="doc">Throws a RuntimeException with the given message. When multiple arguments are passed, cl-format
is used to build the message string.</pre></div><div class="public" id="var-safely"><h3>safely</h3><div class="usage"><code>(safely expr)</code><code>(safely expr fallback)</code></div><pre class="doc">Evaluates an expression safely by catching any exceptions thrown.
If an exception is thrown, the fallback value is returned.</pre></div><div class="public" id="var-swallow"><h3>swallow</h3><div class="usage"><code>(swallow expr)</code></div><pre class="doc">Evaluates an expression swallowing any exceptions. Returns the result of evaluating expr or the
exception if one occurred.</pre></div></div></body></html>