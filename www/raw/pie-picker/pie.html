<html>
<head>
  <title>Pie Color Picker</title>
  <script src="../js/jquery-1.7.1.min.js"></script>
</head>
<body>
  <canvas width="195" height="195" id="colorwheel"></canvas>

  <!-- use clojurescript to get the color discription (ral name, ral number, etc) -->

  <script type="text/javascript">
     jQuery(document).ready(function() {
       // Get context for canvas element.
       var ctx = $('#colorwheel').get(0).getContext('2d');

       // Load color picker image.
       var img = new Image();   // Create new img element  
       img.onload = function() {
         // execute drawImage statements here  This is essential as it waits till image is loaded before drawing it.
         ctx.drawImage(img , 0, 0);
       };  
       img.src = 'RALcolorwheel.png';
       //img.src = 'RALcolorwheelStandards.png';

       // Define a click function.
       //$('#colorwheel').click(function(e) {
       $('#colorwheel').mousemove(function(e) {
         var xpos = e.offsetX;
         var ypos = e.offsetY;

         // Hack for Firefox
         if (e.offsetX==undefined) {
           xpos = e.pageX-$('#colorwheel').offset().left;
           ypos = e.pageY-$('#colorwheel').offset().top;
         }             
         var data = ctx.getImageData(xpos, ypos, 1, 1).data;
         console.log('rgb: ' + [].slice.call(data, 0, 3).join());
       });
     });

     // ? Is it easier to just calculate the color based on the mouse position and using a lookup index?
     // ? How will this work on a tablet? Are the slices too small for a finger?
     // ? Ignore mouse movements that are in the canvas but outside of the circle?
     // ? Magnify the color slice under point?
  </script>

</body>
</html>
